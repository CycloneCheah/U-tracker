<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:300,400,500,700" type="text/css">
    <title>U-tracker</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue-pink.min.css" />
    <link rel="icon" type="image/png" href="https://cdn.discordapp.com/attachments/917613137031745559/917613280221093980/unknown.png"/>
    <script defer src="https://code.getmdl.io/1.3.0/material.min.js"></script>
    <!-- for the chart -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> 
    <style>
        body {
            background-color: beige;
        }

        #title{
            text-align: center;
            font-family: "Times New Roman", Times, serif;
        }
        
        #chartDiv{
            background-color: white;
            margin-top: 20px;
        }

    </style>
    <link rel="stylesheet" href="styles.css"/>
</head>

<body>
    <!-- Uses a transparent header that draws on top of the layout's background -->
    <div class="demo-layout-transparent mdl-layout mdl-js-layout">
        <header class="mdl-layout__header ">
            <div class="mdl-layout__header-row">
                <span class="mdl-layout-title">U-tracker</span>&nbsp;&nbsp;&nbsp;
                <img src="https://cdn.discordapp.com/attachments/917613137031745559/917613280221093980/unknown.png" alt="Our logo" width = 125px>
                <div class="mdl-layout__header-row"></div>
                <div class="mdl-layout__header-row"></div>
                <span class="mdl-layout-title">
                    <!-- <h2>Assignment Details</h2> -->
                </span>
                <!-- Title -->
                <div class="mdl-layout-spacer"></div>
                <!-- Raised button -->
                <div id="backToView">
                    <button class="mdl-button mdl-js-button mdl-button--raised mdl-js-ripple-effect mdl-button--accent"
                        onclick="backToView()">BACK</button>
                </div>
            </div>
        </header>
        <div class="mdl-layout__drawer">
            <span class="mdl-layout-title">Navigation</span>
            <nav class="mdl-navigation">
                <a class="mdl-navigation__link" href="index.html">Main Page</a>
            </nav>
            <!-- <nav class="mdl-navigation">
                <a class="mdl-navigation__link" href="mainGraph.html">Overall Progress</a>
            </nav> -->
        </div>
        <main class="mdl-layout__content">
            <h3 id="title">Assessment</h3>
            <div id="chartDiv" class="mdl-cell--12-col mdl-grid" style="width: 800px;">
                <canvas id="myChart"></canvas>
            </div>
        </main>
    </div>
    <script src="shared.js"></script>
    <script src="graph.js"></script>
    <!-- <script>
        // Get access to the assignment
        let assignmentIndex = localStorage.getItem(ASSIGNMENT_INDEX_KEY);
        let assignment = list.getAssignment(assignmentIndex);
        console.log(typeof assignment);
        // let d = new Date(2021, 12, 12, 14, 58, 11, 0);
        // assignment = new Assignment("Hello", d, 50);

        // Get data of the assignment
        let title = assignment.title;

        // Get tag and update
        let titleId = document.getElementById("title");
        titleId.innerText = title;

        // Access chart tag
        let myChart = document.getElementById("myChart").getContext('2d');

        // Prepare the values of the data
        let days = [];
        let yourProgress = [];
        let expectedProgress = [];

        let progress = assignment.progressData;     // Get the progress data

        let currentIndex = 0;
        let previousIndex = 0;          // set up indexes

        console.log(progress.length);
        let currentDate = parseInt(progress[0][0].getDate());
        let previousDate = currentDate - 1;     // declare date variables
        let lastDay = parseInt(assignment.dueDate.getDate());
        let duration = lastDay - currentDate + 1;
 
        for (let i = 0; i < duration; i++){
            days.push(currentDate + i);
            expectedProgress.push(100 - i * 100 / duration);
        }
        
        while (currentIndex < progress.length){
            currentDate = parseInt(progress[currentIndex][0].getDate());
            if (previousDate == currentDate - 1){       // if previous date and current date is only 1 day apart
                days.push(currentDate);
                yourProgress.push(progress[currentIndex][1]);
                previousIndex = currentIndex;
            }
            else{ // if they are not one day apart, fill in the days in between with the previous progress
                previousDate++;
                yourProgress.push(progress[previousIndex][1]);
            }
            currentIndex++;
        }

        // Prepare how and what data is presented
        let data = {
            labels: days,
            datasets: [{
                label: 'Your Progress',
                backgroundColor: 'rgb(252, 136, 21)',
                borderColor: 'rgb(252, 136, 21)',
                data: yourProgress,
                stepped: true
            },
            {
                label: 'Expected Progress',
                backgroundColor: 'rgb(27, 119, 64)',
                borderColor: 'rgb(27, 119, 64)',
                data: expectedProgress,
                stepped: true
            }]
        };


        // Type of chart and the configurations
        const config = {
            type: 'line',
            data: data,
            options: {}
        };

        // Create and attach the chart
        const theChart = new Chart(myChart, config);
    </script> -->
    
</body>

</html>